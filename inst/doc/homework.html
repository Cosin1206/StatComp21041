<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Shi Cheng" />

<meta name="date" content="2021-12-19" />

<title>homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Shi Cheng</h4>
<h4 class="date">2021-12-19</h4>



<div id="a2104120210916" class="section level2">
<h2>A—21041—2021—09—16</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A program to calculate sum of Fibonacci sequence</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>() </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>] <span class="sc">+</span> x[i<span class="dv">-2</span>]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> s <span class="sc">+</span> x[i]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(s)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 4
## [1] 7
## [1] 12
## [1] 20
## [1] 33
## [1] 54
## [1] 88
## [1] 143</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A program to give a scatter diagram of a linear regression equation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">11</span>) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">68</span>,<span class="dv">59</span>,<span class="dv">79</span>,<span class="dv">36</span>,<span class="dv">22</span>,<span class="dv">95</span>,<span class="dv">120</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using knitr &amp; kable to produce a table of R data &quot;mtcars&quot;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">head</span>(mtcars)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="a2104120210923" class="section level2">
<h2>A—21041—2021—09—23</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">sigma =</span> <span class="dv">2</span>){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">1</span>, f)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;hist&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;function value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;frequence/function value&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(y), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 4</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">sigma =</span> <span class="dv">4</span>){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">1</span>, f)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="st">&quot;hist&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;function value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;frequence/function value&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(y), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 6</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">sigma =</span> <span class="dv">6</span>){</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">1</span>, f)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;hist&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;function value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;frequence/function value&quot;</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(y), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="a-21041-2021-09-30" class="section level2">
<h2>A-21041-2021-09-30</h2>
<div id="write-a-function-to-compute-a-monte-carlo-estimate-of-the-beta3-3-cdf" class="section level3">
<h3>5.4 Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf……</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> x)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  theta_hat  <span class="ot">=</span> x <span class="sc">*</span> <span class="fu">mean</span>((<span class="fu">gamma</span>(<span class="dv">3</span> <span class="sc">+</span> <span class="dv">3</span>)<span class="sc">/</span>(<span class="fu">gamma</span>(<span class="dv">3</span>) <span class="sc">*</span> <span class="fu">gamma</span>(<span class="dv">3</span>))) <span class="sc">*</span> t<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, <span class="at">length =</span> <span class="dv">9</span>)){</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">f</span>(i), <span class="fu">pbeta</span>(i, <span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.008649677 0.008560000
## [1] 0.05753747 0.05792000
## [1] 0.1599597 0.1630800
## [1] 0.3180713 0.3174400
## [1] 0.5002431 0.5000000
## [1] 0.6777754 0.6825600
## [1] 0.8349286 0.8369200
## [1] 0.93691 0.94208
## [1] 0.9922301 0.9914400</code></pre>
</div>
<div id="the-rayleigh-density-156-18.76-is" class="section level3">
<h3>5.9 The Rayleigh density [156, (18.76)] is……</h3>
<p><span class="math display">\[f(x) = \frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},x \geq 0,\sigma &gt;0\]</span></p>
<p><span class="math display">\[
F(x) = \int_{0}^x f(t)d t = \int_{0}^x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}dt= 1 - e^{-x^2/(2\sigma^2)}.
\]</span></p>
<p>Hence: <span class="math display">\[
F^{-1}(u) = \sqrt{-2\log(1-u)}\sigma, 0&lt;u&lt;1.
\]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define function MC.anti() to withdraw samples from distribution Rayleigh with &quot;antithetic&quot; as the optional option</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>MC.anti <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">sigma =</span> <span class="dv">2</span>, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> x[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> u <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    cdf[i] <span class="ot">=</span> <span class="fu">mean</span>(g) </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> <span class="fu">MC.anti</span>(x, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">MC.anti</span>(x)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.anti</span>(x, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.anti</span>(x, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.001892144</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC2))</span></code></pre></div>
<pre><code>## [1] 0.0005856509</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.9041992</code></pre>
<div id="the-percent-reduction-in-variance-is-about-90it-changes-every-time-you-run-the-code" class="section level4">
<h4>The percent reduction in variance is about 90%(it changes every time you run the code)</h4>
</div>
</div>
<div id="find-two-importance-functions-f1-and-f2-that-are-supported-on-1-and" class="section level3">
<h3>5.13 Find two importance functions f1 and f2 that are supported on (1, ∞) and……</h3>
<div id="let-tfrac1xwe-have" class="section level4">
<h4>let <span class="math inline">\(t=\frac{1}{x}\)</span>,we have</h4>
<p><span class="math display">\[g(t)=\frac{1}{t^2\sqrt(2\pi)}e^{-\frac{1}{2t^2}},0&lt;t&lt;1\]</span> #### first,apply the method of substitution to transfer integration into <span class="math display">\[\int_{0}^{1}\frac{1}{t^4\sqrt{2\pi}}e^{-\frac{1}{2t^2}}dt\]</span></p>
</div>
<div id="choose" class="section level4">
<h4>choose</h4>
<p><span class="math display">\[f_1 = \frac{1}{x^2\sqrt{2\pi}}e^{\frac{x^5}{10}-\frac{1}{2x^2}}\]</span> <span class="math display">\[f_2 = \frac{1}{x^5\sqrt{2\pi}}e^{-\frac{1}{2x^2}}\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define function g(x)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (x<span class="sc">**</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> x<span class="sc">**</span><span class="dv">2</span>)) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> (x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#without importance function</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>f0g <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(f0g)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(f0g)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#when f1 is selected as the importance function</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>f1g <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">*</span> <span class="fu">exp</span>(x<span class="sc">**</span><span class="dv">5</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(f1g)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(f1g)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#when f2 is selected as the importance function</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>f2g <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>x)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(f2g)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(f2g)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#show the estimation &amp; se of each situation</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]      [,3]
## theta.hat 0.4034057 0.4039469 0.7229644
## se        0.3076316 0.3042510 0.6205628</code></pre>
</div>
<div id="its-clear-that-when-we-choose-f1-as-the-imporance-function-we-obtain-a-smaller-variancecause-its-se-is-smaller" class="section level4">
<h4>It’s clear that when we choose f1 as the imporance function, we obtain a smaller variance,cause it’s se is smaller</h4>
</div>
</div>
<div id="obtain-a-monte-carlo-estimate-of" class="section level3">
<h3>5.14 Obtain a Monte Carlo estimate of</h3>
<p><span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span></p>
</div>
<div id="by-imporance-sampling" class="section level3">
<h3>by imporance sampling</h3>
<div id="firstapply-the-method-of-substitution-to-transfer-integration-into" class="section level4">
<h4>first,apply the method of substitution to transfer integration into</h4>
<p><span class="math display">\[\int_{0}^{1}\frac{1}{t^4\sqrt{2\pi}}e^{-\frac{1}{2t^2}}dt\]</span></p>
</div>
<div id="choose-1" class="section level4">
<h4>choose</h4>
<p><span class="math display">\[f = \frac{1}{x^2\sqrt{2\pi}}e^{\frac{x^5}{20}-\frac{1}{2x^2}}\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define function g(x)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (x<span class="sc">**</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> x<span class="sc">**</span><span class="dv">2</span>)) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> (x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#when f is selected as the importance function</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>f2g <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">*</span> <span class="fu">exp</span>(x<span class="sc">**</span><span class="dv">5</span><span class="sc">/</span><span class="dv">20</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(f2g)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(f2g)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#show the estimation &amp; se of both situation</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]
## theta.hat 0.4001334
## se        0.3069853</code></pre>
</div>
<div id="hence-the-estimate-is-about-0.4" class="section level4">
<h4>Hence, the estimate is about 0.4</h4>
</div>
</div>
</div>
<div id="a-21041-2021-10-14" class="section level2">
<h2>A-21041-2021-10-14&quot;</h2>
</div>
<div id="questions" class="section level2">
<h2>Questions:</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R) &amp; hypothesis test</p>
</div>
<div id="answers" class="section level2">
<h2>Answers:</h2>
<div id="use-a-monte-carlo-experiment-to-estimate-the-converge" class="section level3">
<h3>6.5 Use a Monte Carlo experiment to estimate the converge</h3>
<div id="solution" class="section level4">
<h4>Solution：</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>UCL;LCL</span></code></pre></div>
<pre><code>## [1] 3.831267</code></pre>
<pre><code>## [1] -0.9881349</code></pre>
</div>
<div id="compare-with-the-interval-for-variance-in-example-6.4the-t-interval-is-more-robust-to-departures-from-normality." class="section level4">
<h4>compare with the interval for variance in Example 6.4,the t-interval is more robust to departures from normality.</h4>
</div>
</div>
<div id="a-use-monte-carlo-simulation-to-investigate-whether-the-empirical" class="section level3">
<h3>6.A Use Monte Carlo simulation to investigate whether the empirical ……</h3>
<p><span class="math display">\[H_0:\mu=\mu_0 \quad vs \quad H_1:\mu \neq \mu_0\]</span></p>
<div id="the-sampled-population-is-chi1" class="section level4">
<h4>(1) the sampled population is <span class="math inline">\(\chi(1)\)</span></h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">1</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu0)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat) <span class="sc">/</span> m)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat, se.hat))</span></code></pre></div>
<pre><code>## [1] 0.053300000 0.002246311</code></pre>
</div>
<div id="the-sampled-population-is-u02" class="section level4">
<h4>(2) the sampled population is <span class="math inline">\(U(0,2)\)</span></h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">2</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> <span class="dv">1</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat) <span class="sc">/</span> m)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat, se.hat))</span></code></pre></div>
<pre><code>## [1] 0.051500000 0.002210153</code></pre>
</div>
<div id="the-sampled-population-is-exp1" class="section level4">
<h4>(3) the sampled population is <span class="math inline">\(Exp(1)\)</span></h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> <span class="dv">1</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat) <span class="sc">/</span> m)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat, se.hat))</span></code></pre></div>
<pre><code>## [1] 0.05130000 0.00220609</code></pre>
</div>
<div id="abviously-all-these-three-conclusions-are-approximately-equal-to-the-nominal-significance-levelalpha" class="section level4">
<h4>Abviously, all these three conclusions are approximately equal to the nominal significance level<span class="math inline">\(\alpha\)</span></h4>
</div>
</div>
<div id="addwhether-the-powers-are-different" class="section level3">
<h3>Add:whether the powers are different?</h3>
<p>Let P1 denote power1 which equals 0.651, P2 denote power2 which equals 0.676</p>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level4">
<h4>(1)what is the corresponding hypothesis test problem?</h4>
<p><span class="math display">\[H_0:P_1=P_2 \quad vs \quad H_1:P_1 \neq P_2\]</span></p>
</div>
<div id="what-test-should-we-use" class="section level4">
<h4>(2)what test should we use?</h4>
<p>paired-t-test<br />
the two methods are operated on the same samples</p>
</div>
<div id="the-least-necessary-information-for-hypothesis-test" class="section level4">
<h4>(3)The least necessary information for hypothesis test?</h4>
<p>sample size: n<br />
sample mean: <span class="math inline">\(\bar{X}\)</span><br />
sample variance: <span class="math inline">\(Var(X)\)</span><br />
t-quantiles under significance level of <span class="math inline">\(\alpha=0.05\)</span></p>
</div>
</div>
</div>
<div id="a-21041-2021-10-21-课堂作业" class="section level2">
<h2>A-21041-2021-10-21 课堂作业</h2>
</div>
<div id="questions-1" class="section level2">
<h2>Questions:</h2>
<p>CLASS TEST</p>
</div>
<div id="answers-1" class="section level2">
<h2>Answers:</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>, <span class="fl">0.878</span>, <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>, <span class="fl">0.680</span>, <span class="fl">2.280</span>, <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>thetastar1 <span class="ot">&lt;-</span> thetastar2 <span class="ot">&lt;-</span> thetastar3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x1)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x2)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">11</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  xstar1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(x1,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  xstar2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(x2,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  thetastar1[b] <span class="ot">&lt;-</span> <span class="fu">mean</span>(xstar1)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  thetastar2[b] <span class="ot">&lt;-</span> <span class="fu">mean</span>(xstar2)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  thetastar3[b] <span class="ot">&lt;-</span> thetastar1[b]<span class="sc">-</span>thetastar2[b]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>x1_sd<span class="ot">=</span><span class="fu">sd</span>(x1)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>x2_sd<span class="ot">=</span><span class="fu">sd</span>(x2)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">x1_mean=</span><span class="fu">mean</span>(x1),<span class="at">x1_sd=</span><span class="fu">sd</span>(x1),<span class="at">x2_mean=</span><span class="fu">mean</span>(x2),<span class="at">x2_sd=</span><span class="fu">sd</span>(x2),<span class="at">SE.boot=</span><span class="fu">sd</span>(thetastar3),<span class="at">se_sample=</span><span class="fu">sqrt</span>(((n<span class="dv">-1</span>)<span class="sc">*</span>x1_sd<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(m<span class="dv">-1</span>)<span class="sc">*</span>x2_sd)<span class="sc">/</span>(m<span class="sc">+</span>n<span class="dv">-2</span>))),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##   x1_mean     x1_sd   x2_mean     x2_sd   SE.boot se_sample 
## -0.731200  1.090448  1.957636  2.169219  0.703529  1.305734</code></pre>
</div>
<div id="a-21041-2021-10-21" class="section level2">
<h2>A-21041-2021-10-21</h2>
</div>
<div id="questions-2" class="section level2">
<h2>Questions:</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
</div>
<div id="answers-2" class="section level2">
<h2>Answers:</h2>
<div id="repeat-example-6.8-for-mardias-multivariate-skewness-test." class="section level3">
<h3>(1) Repeat Example 6.8 for Mardia’s multivariate skewness test.</h3>
<p>while X,Y are iid, we know that the maximum likelihood estimator of covariance is <span class="math display">\[\hat{\Sigma}=\frac{1}{n} \sum_{i=1}^n(X_i-\bar{X})(X_i-\bar{X})^{T}\]</span> So, we present the following code</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#different sample size </span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>cv_r <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">975</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>cv_l <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">025</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">numeric</span>(d)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>sigma0 <span class="ot">&lt;-</span> <span class="fu">diag</span>(d)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>b_1d <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#define function sk to calculate the sample skewness</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,k){</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(k, mu, sigma0)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  xigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, d, d)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#define the maximum likelihood estimator  </span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    xigma <span class="ot">&lt;-</span>  xigma <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>k) <span class="sc">*</span> (x[i,]<span class="sc">-</span>x_bar) <span class="sc">%o%</span> (x[i,]<span class="sc">-</span>x_bar)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  xigma <span class="ot">&lt;-</span> <span class="fu">solve</span>(xigma)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#define the skewness statistic</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>      b_1d <span class="ot">&lt;-</span> b_1d <span class="sc">+</span> ((x[i,]<span class="sc">-</span>x_bar) <span class="sc">%*%</span> xigma <span class="sc">%*%</span> (x[j,]<span class="sc">-</span>x_bar))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  chi_test <span class="ot">&lt;-</span> b_1d <span class="sc">/</span> k<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k<span class="sc">/</span><span class="dv">6</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chi_test)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i])</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i])</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>( <span class="fu">sk</span>(x,n[i]) <span class="sc">&gt;=</span> cv_r <span class="sc">||</span> <span class="fu">sk</span>(x,n[i]) <span class="sc">&lt;=</span> cv_l ) </span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#calculate the proportion of samples located in reject area</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.10 0.08 0.05 0.06 0.07 0.09</code></pre>
</div>
<div id="repeat-example-6.10-for-power-of-the-skewness-test." class="section level3">
<h3>(2) Repeat Example 6.10 for power of the skewness test.</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>cv_r <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">975</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>cv_l <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">025</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#define function sk to calculate the sample skewness</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k){</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(k, mu, sigma0)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  xigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, d, d)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#define the maximum likelihood estimator  </span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    xigma <span class="ot">&lt;-</span>  xigma <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>k) <span class="sc">*</span> (x[i,]<span class="sc">-</span>x_bar) <span class="sc">%o%</span> (x[i,]<span class="sc">-</span>x_bar)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  xigma <span class="ot">&lt;-</span> <span class="fu">solve</span>(xigma)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">#define the skewness statistic</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>      b_1d <span class="ot">&lt;-</span> b_1d <span class="sc">+</span> ((x[i,]<span class="sc">-</span>x_bar) <span class="sc">%*%</span> xigma <span class="sc">%*%</span> (x[j,]<span class="sc">-</span>x_bar))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  chi_test <span class="ot">&lt;-</span> b_1d <span class="sc">/</span> k<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k<span class="sc">/</span><span class="dv">6</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(chi_test)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for each epsilon</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#for each replicate</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> k, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x, k) <span class="sc">&gt;=</span> cv_r <span class="sc">||</span> <span class="fu">sk</span>(x, k) <span class="sc">&lt;=</span> cv_l)</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>  pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) <span class="co">#add standard errors</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6OmY6OpA6kNtmAABmADpmOgBmtttmtv+QOgCQZgCQ2/+2ZgC22/+2///bkDrbtmbb////tmb/25D/27b//7b//9v///81h/HBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGU0lEQVR4nO2di3raNhhAva1Jt9J22djYoMTv/5gFfEE2mCPfkAPn9EtTxZZkH35Jlq06WS43yVIfwNJREKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAgoCJBWUfhlSCpi1uPhQEKAi4s6D+TTs1RhCgIEBBgIIABQEKAhQEKAhQEKAgYCZB6yx7eX87zCj+nKS4hMwjaPPp/4Ojlzzfr75MUFxKZhH0/nbQsv3l77xQNba4pMwiaL86tKztr//m1d/jikuKEQTM3AedVI0uLiWOYoDXQYCCgLkFbRzF+lXnTfs0xc2HgoCZBJ2G+AMdPdDTC9pk5fXhNvNC8QrB9bNTjWucJqsFTlavYQQRm2oOZh/UwX5VjGId8aOgexc3HwoCFAQoCFAQoCBAQYCCgP6COp/kzFNvavoLCmai96g3NQOaWNcEfZ56UzMkgjK4W3irFG/apyluPhQEDGpiL3esNzUDIqjshE6rW+avNzWDm9h+NWowe3BBxyAygrp23L0OG+KH1ZuaIZ20F4qw4yGERo9jDy0oPz7X6VxcF7B77dzp0QXdbmn1bKR7QvLIgtY8FyufFz5nBB3Cg0f4/er4yPA5BUWyPlh8VkGnLqbzoXLFJvvypILK/2OA7Wz3+ttTCnp/K856jTH0/tZ9LfDAgvZfi9AZd+f1gQVVEdS1NKrJMy4k354azibmUvqylCe4Jx1xmTxlvanxnjTgQnLAheSAy4ABF5IDRhDgQnLAheSA10GAggAFAQoCFAQoCFAQoCBAQYCCAAUBdxb0DDft71xvahQEKAhQEKAgQEGAggAFAQ8saODVaCtbsmfz2emrvqw+py9+NvCrKqxR9q39O7fPICj22Xzj6I7nUPyppiLVh3k9Gci+ki6lBLlvn0S5+Wq2KPoIin2yWh1QEDp59UFm51M6H3vjq+vMi3Tt9OLM6/1C7UGQNbKlfTafNcmD73WDaH2vGs1ZWJ1unWpZTfvM216DUvIyfsts5+2TC4qMoOI8squagmM8n1qYPPc0QToPzYQxk9X2WhF1LiXYv77bMJeguGfz9SEGbs52Lj/7tpCGiHr3IMLOYVUH3LWIys9i6orqSJprFIt5Nh/0zqGnakCpj7n+oOtkY6y6aGqtnqN95lVbajTZevNFtpkExRRXfVBnO0GjK3a6OYpdfOb1D1un2khmtczwKK4d4YyjWGRx9VfdGOreOa6M6595ZM1t7Td2jzua2B2b3FxIHvioIj5ez5Uy4/L2q+LOERR0NR+ElE3sQ6AgYCZBLiS/jQvJbxMz1fgwzCEoYrIaVyhsH7d5bPYRu0dEUFyhjyooYrIaV+jDCuLJalyhjytookIVNG67ghQ0bruCnl7QI6EgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBUwrahi983/Z++3s7B7/RsTv7Jot68XMEEwo6vspzWx1jI9E/+zHNr03tzH58n+h2GkPTCSoeCq1fLhP9s+en5wN9BLVqf+lZezfTCSpegVsuHGok+mc//uvTX30ENbIvVNDnY3yXj1wbif7ZT8lefVAz+yKbWNEBlN1AI9E/+6nF9BLUqrD/ENHFQgUdH22PELQ+RNLudYpfubfQJnZKDG9i/XvAbpbZSW/KNSrxvUgje//47Waxw3zPCGpkL2xN8jsJF3yh2PNKupF9kX3QqWEcj7C4Ctn0Hkca2fPeU41G9uMvCZnEj5NVQkGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFi8oP9es+yPKZaKDWTpgnafv5cr6hKxdEH7r9Msdx7M0gXlP751v5TwHixd0H71Pe0BLF3QNGt5R7B0QbvX7/mP1ST/b2cYSxeU775l2e//pKt/8YJSoyBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCPgJDw8i/c44ggsAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div id="a-21041-2021-10-28" class="section level2">
<h2>A-21041-2021-10-28</h2>
</div>
<div id="questions-3" class="section level2">
<h2>Questions:</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R).</p>
</div>
<div id="answers-3" class="section level2">
<h2>Answers:</h2>
<div id="section" class="section level3">
<h3>7.7</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#define sample size &amp; number of replicates</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sample.size <span class="ot">&lt;-</span> <span class="fu">dim</span>(scor)[<span class="dv">1</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">#get samples from dataset &quot;scor&quot; using bootstrap</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>sample.size, <span class="at">size =</span> sample.size, <span class="at">replace =</span> T)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  data_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor[index,])</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  data_ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(data_cor)<span class="sc">$</span>value</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  data_ev_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(data_ev)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  data_lambda <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(data_ev))</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  data_lambda_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(data_ev)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  theta_hat[i] <span class="ot">&lt;-</span> data_lambda_1<span class="sc">/</span>data_ev_sum</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>theta_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta_hat)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>theta_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta_hat)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co">#present the conclusion</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(theta_mean,theta_sd))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta_mean</th>
<th align="right">theta_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6365785</td>
<td align="right">0.0433233</td>
</tr>
</tbody>
</table>
</div>
<div id="section-1" class="section level3">
<h3>7.8</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#define sample size &amp; number of replicates</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sample.size <span class="ot">&lt;-</span> <span class="fu">dim</span>(scor)[<span class="dv">1</span>]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">#get samples from dataset &quot;scor&quot; using bootstrap</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>sample.size, <span class="at">size =</span> sample.size, <span class="at">replace =</span> T)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  data_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor[index,])</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  data_ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(data_cor)<span class="sc">$</span>value</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  data_ev_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(data_ev)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  data_lambda <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(data_ev))</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  data_lambda_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(data_ev)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  theta_hat[i] <span class="ot">&lt;-</span> data_lambda_1<span class="sc">/</span>data_ev_sum</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">=</span> <span class="fu">mean</span>(theta_hat[<span class="sc">-</span>i])</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta_hat)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>sd_jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta_hat))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>theta_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(bias.jack)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co">#present the conclusion</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(theta_bias, sd_jack))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta_bias</th>
<th align="right">sd_jack</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.0013294</td>
</tr>
</tbody>
</table>
</div>
<div id="section-2" class="section level3">
<h3>7.9</h3>
<div id="percentile" class="section level4">
<h4>Percentile</h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define sample size &amp; number of replicates</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>sample.size <span class="ot">&lt;-</span> <span class="fu">dim</span>(scor)[<span class="dv">1</span>]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#get samples from dataset &quot;scor&quot; using bootstrap</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>sample.size, <span class="at">size =</span> sample.size, <span class="at">replace =</span> T)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  data_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor[index,])</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  data_ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(data_cor)<span class="sc">$</span>value</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  data_ev_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(data_ev)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  data_lambda <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(data_ev))</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  data_lambda_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(data_ev)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  theta_hat[i] <span class="ot">&lt;-</span> data_lambda_1<span class="sc">/</span>data_ev_sum</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">=</span> <span class="fu">quantile</span>(theta_hat,<span class="fl">0.025</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">=</span> <span class="fu">quantile</span>(theta_hat,<span class="fl">0.975</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(c1,c2)))</span></code></pre></div>
<pre><code>##          2.5%     97.5%
## [1,] 0.544174 0.7129965</code></pre>
</div>
<div id="bca" class="section level4">
<h4>BCa</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define sample size &amp; number of replicates</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>sample.size <span class="ot">&lt;-</span> <span class="fu">dim</span>(scor)[<span class="dv">1</span>]</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#get samples from dataset &quot;scor&quot; using bootstrap</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>sample.size, <span class="at">size =</span> sample.size, <span class="at">replace =</span> T)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  data_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor[index,])</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  data_ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(data_cor)<span class="sc">$</span>value</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  data_ev_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(data_ev)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  data_lambda <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(data_ev))</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  data_lambda_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(data_ev)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  theta_hat[i] <span class="ot">&lt;-</span> data_lambda_1<span class="sc">/</span>data_ev_sum</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">=</span> <span class="fu">quantile</span>(theta_hat,<span class="fl">0.025</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">=</span> <span class="fu">quantile</span>(theta_hat,<span class="fl">0.975</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(c1,c2)))</span></code></pre></div>
<pre><code>##           2.5%     97.5%
## [1,] 0.5444295 0.7171839</code></pre>
</div>
</div>
<div id="b" class="section level3">
<h3>7.B</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define a function to compute the sample skewness</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># the skewness of normal populations</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># the sample size in bootstrap</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span> <span class="co"># replicate time in Monte Carlo experiments</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>boot.skew <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skewness</span>(x[i])</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> X, <span class="at">statistic =</span> boot.skew, <span class="at">R =</span> <span class="fl">1e3</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>cover.prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span> mu))</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>left.omit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span> mu))</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>right.omit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span> mu),</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span> mu),</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span> mu))</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>cover.norm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(cover.prob,left.omit,right.omit),<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,)</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cover.norm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cover probability&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>)</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cover.norm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;standard normal bootstrap confidence interval&quot;</span>,<span class="st">&quot;basic bootstrap confidence interval&quot;</span>,<span class="st">&quot;percentile bootstrap confidence interval&quot;</span>)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(cover.norm))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">cover probability</th>
<th align="right">miss on the left</th>
<th align="right">miss on the right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">standard normal bootstrap confidence interval</td>
<td align="right">0.907</td>
<td align="right">0.046</td>
<td align="right">0.047</td>
</tr>
<tr class="even">
<td align="left">basic bootstrap confidence interval</td>
<td align="right">0.900</td>
<td align="right">0.048</td>
<td align="right">0.052</td>
</tr>
<tr class="odd">
<td align="left">percentile bootstrap confidence interval</td>
<td align="right">0.978</td>
<td align="right">0.013</td>
<td align="right">0.009</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)  <span class="co"># the skewness of chi-squared distribution</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># the sample size in bootstrap</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span> <span class="co"># replicate time in Monte Carlo experiments</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>boot.skew <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skewness</span>(x[i])</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df =</span> <span class="dv">5</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> X, <span class="at">statistic =</span> boot.skew, <span class="at">R =</span> <span class="fl">1e3</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>cover.prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span> mu))</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>left.omit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span> mu),</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span> mu))</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>right.omit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span> mu),</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span> mu),</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span> mu))</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>cover.chisq <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(cover.prob,left.omit,right.omit),<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cover.chisq) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cover probability&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cover.chisq) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;standard normal bootstrap confidence interval&quot;</span>,<span class="st">&quot;basic bootstrap confidence interval&quot;</span>,<span class="st">&quot;percentile bootstrap confidence interval&quot;</span>)</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(cover.chisq))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">cover probability</th>
<th align="right">miss on the left</th>
<th align="right">miss on the right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">standard normal bootstrap confidence interval</td>
<td align="right">0.729</td>
<td align="right">0.023</td>
<td align="right">0.248</td>
</tr>
<tr class="even">
<td align="left">basic bootstrap confidence interval</td>
<td align="right">0.691</td>
<td align="right">0.054</td>
<td align="right">0.255</td>
</tr>
<tr class="odd">
<td align="left">percentile bootstrap confidence interval</td>
<td align="right">0.725</td>
<td align="right">0.000</td>
<td align="right">0.275</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="a-21041-2021-11-04" class="section level2">
<h2>A-21041-2021-11-04</h2>
</div>
<div id="questions-4" class="section level2">
<h2>Questions:</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. I Unequal variances and equal expectations I Unequal variances and unequal expectations I Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) I Unbalanced samples (say, 1 case versus 10 controls) I Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answers-4" class="section level2">
<h2>Answers:</h2>
<div id="section-3" class="section level3">
<h3>8.2</h3>
<p>The Spearman rank correlation statistic is <span class="math display">\[\rho=\frac{\sum_{i=1}^n R(x_i)R(y_i) - n(\frac{n+1}{2})^2}{\sqrt{\sum_{i=1}^n R^2(x_i) - n(\frac{n+1}{2})^2}\sqrt{\sum_{i=1}^n R^2(y_i) - n(\frac{n+1}{2})^2}}\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># part A: cor.test</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#randomly generating x &amp; y as the samples</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">78</span>, <span class="dv">78</span>, <span class="dv">87</span>, <span class="dv">84</span>, <span class="dv">87</span>, <span class="dv">90</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">71</span>, <span class="dv">77</span>, <span class="dv">79</span>, <span class="dv">86</span>, <span class="dv">84</span>, <span class="dv">90</span>, <span class="dv">78</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate Spearman rank correlation and return the p-value</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> a<span class="sc">$</span>p.value</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># part B: permutation.test</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># form the data</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="cf">function</span>(s,t){</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(s)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  Rx <span class="ot">&lt;-</span> <span class="fu">rank</span>(s, <span class="at">ties.method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  Ry <span class="ot">&lt;-</span> <span class="fu">rank</span>(t, <span class="at">ties.method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    rho1 <span class="ot">=</span> <span class="fu">sum</span>(Rx[i] <span class="sc">*</span> Ry[i]) <span class="sc">-</span> m <span class="sc">*</span> ((m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    rho2 <span class="ot">=</span> <span class="fu">sum</span>(Rx[i]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> m <span class="sc">*</span> ((m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    rho3 <span class="ot">=</span> <span class="fu">sum</span>(Ry[i]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> m <span class="sc">*</span> ((m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  rho1<span class="sc">/</span><span class="fu">sqrt</span>(rho2 <span class="sc">*</span> rho3)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>rho_init <span class="ot">&lt;-</span> <span class="fu">rho</span>(x,y)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly choosing data from z</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> S1 <span class="ot">&lt;-</span> S2 <span class="ot">&lt;-</span> rho_per <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">sample</span>(z, <span class="at">size =</span> <span class="dv">14</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> S[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> S[<span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  rho_per[i] <span class="ot">&lt;-</span> <span class="fu">rho</span>(S1,S2)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>p_perm <span class="ot">&lt;-</span> <span class="fu">mean</span>(rho_per <span class="sc">&lt;</span> rho_init)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(p, p_perm))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">p</th>
<th align="right">p_perm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.154291</td>
<td align="right">0.1268</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="design-task" class="section level2">
<h2>design task</h2>
<div id="generate-two-different-distribution-with-unequal-variances-and-equal-expectations" class="section level3">
<h3>(1) generate two different distribution with Unequal variances and equal expectations</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#define functions to calculate the power using different methods</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>tnn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  i_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  i_2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  (i_1 <span class="sc">+</span> i_2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> tnn,<span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1500</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> n_2 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n_1 <span class="sc">+</span> n_2 </span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n_1, n_2)</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="co">#giving the parameters of two different distributions</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>mu_1 <span class="ot">&lt;-</span> mu_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>sigma_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  data1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_1, mu_1, sigma_1)</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_2, mu_2, sigma_2)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data1, data2)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using nn method</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(data,N,k)<span class="sc">$</span>p.value</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using energy method</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(data,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using ball method</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>data1, <span class="at">y=</span>data2, <span class="at">num.permutations=</span>R, <span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2846</span>)<span class="sc">$</span>p.value</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values <span class="sc">&lt;</span> alpha)</span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>power</span></code></pre></div>
<pre><code>## [1] 0.1 0.1 0.2</code></pre>
<div id="as-the-result-shows-the-ball-method-presents-the-biggest-power-value-both-nn-and-energy-method-perform-poorly-while-the-power-of-energy-method-is-a-bit-higher-than-the-nn-method." class="section level4">
<h4>AS the result shows, the ball method presents the biggest power value, both NN and energy method perform poorly while the power of energy method is a bit higher than the nn method.</h4>
</div>
</div>
<div id="generate-two-different-distribution-with-unequal-variances-and-unequal-expectations" class="section level3">
<h3>(2) generate two different distribution with Unequal variances and unequal expectations</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">#define functions to calculate the power using different methods</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>tnn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  i_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  i_2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  (i_1 <span class="sc">+</span> i_2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> tnn,<span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1500</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">&lt;-</span> n_2 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n_1 <span class="sc">+</span> n_2 </span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n_1, n_2)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co">#giving the parameters of two different distributions</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>mu_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>mu_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>sigma_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  data1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_1, mu_1, sigma_1)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_2, mu_2, sigma_2)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data1, data2)</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using nn method</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(data,N,k)<span class="sc">$</span>p.value</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using energy method</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(data,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using ball method</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>data1, <span class="at">y=</span>data2, <span class="at">num.permutations=</span>R, <span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2846</span>)<span class="sc">$</span>p.value</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values <span class="sc">&lt;</span> alpha)</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>power</span></code></pre></div>
<pre><code>## [1] 0.67 0.96 0.91</code></pre>
<div id="as-the-result-shows-the-nn-method-performs-worst-both-energy-and-ball-method-perform-poorly-while-the-power-of-energy-method-is-a-bit-higher-than-the-nn-method." class="section level4">
<h4>AS the result shows, the nn method performs worst, both energy and ball method perform poorly while the power of energy method is a bit higher than the nn method.</h4>
</div>
</div>
<div id="non-normal-distributions-t-distribution-with-1-df-heavy-tailed-distribution-bimodel-distribution-mixture-of-two-normal-distributions" class="section level3">
<h3>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</h3>
<div id="we-generate-a-bimodel-distribution" class="section level4">
<h4>we generate a bimodel distribution:</h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="dv">1500</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  mydata1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rt</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  mydata2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rt</span>(n2,<span class="dv">2</span>,<span class="dv">5</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  mydata <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mydata1,mydata2)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(mydata,N,k)<span class="sc">$</span>p.value</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(mydata,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>mydata1,<span class="at">y=</span>mydata2,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2846</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.65 0.43 0.78</code></pre>
</div>
<div id="the-result-suggests-that-for-bimodel-distributions-the-ball-method-performs-the-best-while-the-energy-method-performs-worst." class="section level4">
<h4>The result suggests that for bimodel distributions, the ball method performs the best, while the energy method performs worst.</h4>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples:</li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mu_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>mu_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>sigma_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>n_1 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>n_2 <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n_1<span class="sc">+</span>n_2 </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n_1,n_2)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1500</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  mydata1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_1,mu_1,sigma_1)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  mydata2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n_2,mu_2,sigma_2)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  mydata <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mydata1,mydata2)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(mydata,N,k)<span class="sc">$</span>p.value</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(mydata,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>mydata1, <span class="at">y=</span>mydata2, <span class="at">num.permutations=</span>R, <span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2846</span>)<span class="sc">$</span>p.value</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.30 0.92 0.85</code></pre>
</div>
<div id="the-result-suggests-that-the-energy-method-performs-the-best-while-the-nn-method-performs-much-worse-than-the-other-two." class="section level4">
<h4>The result suggests that the energy method performs the best, while the nn method performs much worse than the other two.</h4>
</div>
</div>
</div>
<div id="from-the-above-four-situations-we-conclude-that-different-method-is-efficient-in-different-field-there-is-no-such-a-widly-useful-way-to-solve-all-the-problems." class="section level2">
<h2>from the above four situations, we conclude that different method is efficient in different field, there is no such a widly useful way to solve all the problems.</h2>
</div>
<div id="a-21041-2021-11-11" class="section level2">
<h2>A-21041-2021-11-11</h2>
<p>Exercies 9.3 Exercies 9.8</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span></p>
</div>
<div id="answers-5" class="section level2">
<h2>Answers:</h2>
<div id="section-4" class="section level3">
<h3>9.3</h3>
<p>Take x0=15 and <span class="math inline">\(\sigma=c(0.05,0.5,1,16)\)</span> as an example</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(mu,lambda,sigma,x0,N){</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      <span class="co">#用dcauchy来计算cauchy分布在给定点处的密度函数值</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> (<span class="fu">dcauchy</span>(y,mu,lambda)<span class="sc">/</span><span class="fu">dcauchy</span>(x[i<span class="dv">-1</span>], mu, lambda)))</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">#给柯西分布的参数、提议分布的方差以及初始值x0赋值</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>; lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">16</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co">#生成不同方差下的四个链</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(mu,lambda, sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(mu,lambda, sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(mu,lambda, sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(mu,lambda, sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="co">#计算每个链中待选点的拒绝率</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k,rw4<span class="sc">$</span>k)<span class="sc">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.00200 0.05175 0.22975 0.80475</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#绘制四个链的轨迹图</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2,2))</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>refline <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>), mu, lambda)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x,rw2<span class="sc">$</span>x,rw3<span class="sc">$</span>x,rw4<span class="sc">$</span>x)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rw[,j],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span>.(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">&#39;X&#39;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///9nhekvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJeUlEQVR4nO2dAXecuB3EJ03SXuO218u57W2zdvT9P+WZBYEWJJDEn53B1u+9+FgYjYYJC/iF3YNrrAJ2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfGdqeBVZCt3XHAXEixOw6YCyl2xwFz4dF29SOPnS5bWGRX4VoxZA/Z02ULi+wqXCuG7CF7umxhkV2Fa8WQPWRPly0ssqtwrRiyh+zpsoVFdhWuFUP2kD1dtrDIrsK1YsgesqfLFhbZ5d/Jz0c+iuzpsoVFdq2gdbuC3wVnIx9G9nTZwhI7q4LKXXZNt09YZNcK2rBrBW3YWRVU4bNjun3CIrvyHYuOeI8FnQZWQbW2e4+g0gkPM860K7bdWVDxezFbX2qcaYdS41bQ1sCY/n0XVObcCoqJEV8OVm6brAxfHWAuXHeZXz1bQRt2FQVF9K2gcHmpL7ifO19BG/uGXhSs+IAFrVj321pBaRmmn37gUo78m4VW0Ma0Jy4oOoF5Qaf7ZdUZFZSXDyctCMkJMgtKDY/YZelm3rbCQruHFzQJ84bkiIqEhXYGBd02R4dHlKcryLWCNuzgb5ejMkw/vXxRUXr4wu39FjRu/XgFuYyCgt36yAVFplgUhGVBK6ewhRvCeXKGnLsg3GmSM43bg4L8n8kpYZD0rRZW2A2XISS2+IKGP+PvU/7yh9mwO4e1goBgUj8qvCIszFbIFlbYJQqC34JJga2CkCoIYUE3y7MWhGD1fUHwBXklprefH4XgpI2h1MEkVtB0EzYa3EVTKmjc7WB1sqBxRFjQ7LWvIzAZBHcM7UzHpQv+EnQKCnZ7PJTCfRsk/j9+xNSrGxtB/7p3xLhwt2FWkT+Ugr8LFO53tvDGz+/9nH/5I8cuOOAjBU31hQWF+9cb3u1qaDkraElYUDCkbL+zhR0XfOsXrn5h1S4SeVybXVC4q1gUtFBGCor75u7zUvjf1NHxdvyMtVw+/9i2WytoXkpeQYndv58t0cuugl5/9a9fvibfPu716Te/eL1XzWY3Lyi6nyllYsy4uqqgp0+/3xae06eX8iMovs9T2hMV1J19v3SHT/czzQXDIZR3DnLRPQkuQbOCZlei0CNdk1sW5KI97Suo2+dP/8JwHCV5fernSBw/sYIc7iqJFuT8Sfuuj8AkuqveY5p6tJnO5tP46fKwDLrCJOwPop3M5sVwcb8vaNgB56/awzq/ZqzNe4xFBwW5wPF+9t7fdzRNvregS3cErZyACu38y37FSkFuPArgHYYWvMe8IDcclImCvIkL3qS+qTFQcUFv750vt5+Jc0uh3eIl/G6PPUybsCjIBXvih44W0/p0QXevLArKu4pl2yVfwkUKutfBBeX4FcHBEIzLLGj8KwimLy4o6z4o2y75Ei5e0HzUYhyWWyoKCtYuZ02wFKbvpMvt5i/hcgqKjMNyPdysnuReGxe0C6y/hLMsaDE0ZuWmchBoEtLNKHvB+kuM65DSRF0Xx0p8aMIKkRcZsxYKTezgGAXFNDnSMqGJHVxlQXmzZVgVSws8Dez86bIwQaqgwtmrpAWeBnaxgnJcM8cUWGdLCzwN7A4uqMTSXGhi1wrasGsFbdjVFlQ+xMzSeO4tO7SCNrcbz1gJzIU2dmgFbW43nrESmAtt7NAK2tp+wCW7BpgL111GNqf7mAVl20HkHdYK2gLmQhu7VtDWdpFTUCtoC5gLbexaQaeBVdDW9g9/BG0KjCesBeZCI7tW0JbAeMJaYC40smsFbQmMJ6wF5kIju1bQlsB4wlpgLrxR9mGWqKBswsOAubCj8MMsUUHRhMcBc6Gr+ChCTFAy4YHAXOjWPsySb/euC2pH0BalH2bZO9+BwFx4o/DDLLvnOw6YC43sjOerBuZCIzvj+aqBufDG5e3tdTsNXaqvYkXzHQfMhR2XT7+/nYa6T5Vdcj6zunu+A4G50PnL/M/vb6fodgTF8DeKz59/tIJijDeKz19aQVF8LW+3Q7UFqQBz4Q1/K/3zeyvo4HnZwFw4EfzOamHHAebCidWCTgOpoDLTTB1FVinvaAVt0AraTa5ppo4iq5TbmmbqKLJKua1ppo4iq5TbmmbqKLJKua1ppo4iq5TbmmbqKLJK+ccD7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdWDueMXK11K//O2PO81yIZ9L2qTCLQVsbCaub8muqXSvT7d/sh41y4V8ugcFEiYVbklg4jLR/5PHc/yru6/9hxhGzXIhn9enb51TzKTCLQ1MXCZevnaPN8Sfjrni2+0B9FGzXCicrSvIzi0KLEwCXv7aHdmpB/H7DaNmuVA4W/dMoJ1bFFiYBPRv/eQJ4JZ61CwXyuZC9zy7lVsCWJgEPLKg/nnJkxX02LdY18LJ3mIbJ0jjk3RndbKT9MYl9mp2me9bePM72WV+4ybtanej+Pz5R1/FuW4Ug98AYgwnhlGzXMjnGf5zERZuKWBj834BO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wAhQzPET8OPHa6vQzPET8QPHa6nVxXvgz9IPDY6fbhnyN+JHjsdDn8/M/X23dERb+EpxXUPTr2P/fya+ILmVtB/hnYv/evnoevHPMPHLaChgpe/xF/hK4V5Aua/gcDka0PBI+dLoO+mv4p3/YWi3H99O/+O5mjG1tBzv3/n8Av7Sp2EsAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOo8yf2gdFlsY3EEQAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#丢弃链的前1000个值</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>rw_new1 <span class="ot">&lt;-</span> rw1<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">4000</span>]</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>rw_new2 <span class="ot">&lt;-</span> rw2<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">4000</span>]</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>rw_new3 <span class="ot">&lt;-</span> rw3<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">4000</span>]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>rw_new4 <span class="ot">&lt;-</span> rw4<span class="sc">$</span>x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">4000</span>]</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">#计算理论及丢弃前1000个值后的四组链值的十分位数</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(probs,mu,lambda)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(rw_new1,probs)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(rw_new2,probs)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(rw_new3,probs)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(rw_new4,probs)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co">#绘制理论十分位数折线及四个链的十分位数点</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">~</span>probs, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;分位数&quot;</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>), <span class="at">ylab=</span><span class="st">&quot;十分位数值&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>), </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;理论及四组链值的十分位数折线图&quot;</span>,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(probs, df1, <span class="at">pch=</span> <span class="dv">22</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(probs, df2, <span class="at">pch=</span> <span class="dv">23</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(probs, df3, <span class="at">pch=</span> <span class="dv">24</span>, <span class="at">col=</span><span class="st">&quot;pink&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(probs, df4, <span class="at">pch=</span> <span class="dv">25</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">inset=</span>.<span class="dv">05</span>, <span class="fu">c</span>(<span class="st">&quot;理论&quot;</span>,<span class="st">&quot;方差0.05&quot;</span>,<span class="st">&quot;方差0.5&quot;</span>,<span class="st">&quot;方差1&quot;</span>,<span class="st">&quot;方差16&quot;</span>), </span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;green&quot;</span>), </span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;green&quot;</span>), </span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">25</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> In the first plot with σ = 0.05, the Chain 1 has not converged to the target in 4000 iterations. The chain 2 in the second plot generated with σ = 0.5 is converging very slowly and requires a much longer burn-in period. In the third plot (σ = 1) the chain is mixing well and converging to the target distribution after a burn-in period of about 1700. Finally, in the fourth plot, where σ = 16, the chain 4 converges, but it is inefficient.</p>
<p>compare the deciles of the generated observations with the deciles of the standard Cauchy distribution, we obverse that chain 4 (with σ = 1) fit the standard Cauchy distribution best.</p>
</div>
<div id="section-5" class="section level3">
<h3>9.8</h3>
<p>Use the Gibbs sampler to generate a chain with target joint density f(x, y), take [a = 100, b = 100, n = 1000, x0 = 100, y0 = 0.5] as my example, the R code is as follow:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span> <span class="co">#length of chain</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>burn_period <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize the parameters</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize the variate&#39;s value</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chain</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">1</span>]</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i])</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i]<span class="sc">+</span>a, n<span class="sc">-</span>x[i]<span class="sc">+</span>b)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn_period <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N,]</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">4</span>, <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">xlim=</span><span class="fu">range</span>(m[,<span class="dv">1</span>]), <span class="at">ylim=</span><span class="fu">range</span>(m[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="the-result-is-as-the-figure-shows" class="section level4">
<h4>The result is as the figure shows</h4>
</div>
</div>
<div id="plus" class="section level3">
<h3>9.3plus</h3>
<p>take [mu = 100, lambda = 100] for cauchy distribution, [sigma = 1] for proposal distribution as my example to generate 4 chains</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>normal.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, lambda, sigma, N, X1) {</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generates a Metropolis chain for Normal(0,1)</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#用dcauchy来计算cauchy分布在给定点处的密度函数值</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> (<span class="fu">dcauchy</span>(y,mu,lambda)<span class="sc">/</span><span class="fu">dcauchy</span>(x[i<span class="dv">-1</span>], mu, lambda)))</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co">#parameter of cauchy distribution</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> .<span class="dv">01</span>  <span class="co">#parameter of cauchy distribution</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co">#parameter of proposal distribution</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>       <span class="co">#number of chains to generate</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20000</span>   <span class="co">#length of chains</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2000</span>    <span class="co">#burn-in length</span></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">25</span>)</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">normal.chain</span>(mu, lambda, sigma, n, x0[i])</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.177011</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">#give the line of R_hat = 1.2</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figures above we can seen that Rˆ over time 1001 to 20000 decreases slowly, the dash line suggest that the chain has approximately converged to the target distribution within approximately 14900 iterations.</p>
</div>
<div id="plus-1" class="section level3">
<h3>9.8plus</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2OpenBUGS)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span> <span class="co">#length of chain</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>burn_period <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize the parameters</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize the variate&#39;s value</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chain</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">1</span>]</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i])</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i]<span class="sc">+</span>a, n<span class="sc">-</span>x[i]<span class="sc">+</span>b)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn_period <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N,]</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> m[,<span class="dv">2</span>]</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span> (<span class="st">&quot;N&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">theta =</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">100</span>), <span class="at">mu.theta =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.theta =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>model{</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    y[j] <span class="sc">~</span> <span class="fu">dnorm</span> (theta[j], tau.y[j])</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>    theta[j] <span class="sc">~</span> <span class="fu">dnorm</span> (mu.theta, tau.theta)</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>    tau.y[j] <span class="ot">&lt;-</span> <span class="fu">pow</span>(sigma.y[j], <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>  mu.theta <span class="sc">~</span> <span class="fu">dnorm</span> (<span class="fl">0.0</span>, <span class="fl">1.0E-6</span>)</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>  tau.theta <span class="ot">&lt;-</span> <span class="fu">pow</span>(sigma.theta, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>  sigma.theta <span class="sc">~</span> <span class="fu">dunif</span> (<span class="dv">0</span>, N)</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">xyplot</span>(myModel.coda[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myModel.coda[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a><span class="fu">acfplot</span>(myModel.coda[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">lag.max=</span><span class="dv">200</span>)</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.plot</span>(myModel.coda[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<p>fail to obtain a conclusion</p>
</div>
</div>
<div id="a-21041-2021-11-18" class="section level2">
<h2>A-21041-2021-11-18</h2>
</div>
<div id="questions-5" class="section level2">
<h2>Questions:</h2>
<p>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R) I Suppose T1, . . . , Tn are i.i.d. samples drawn from the exponential distribution with expectation λ. Those values greater than τ are not observed due to right censorship, so that the observed values are Yi = TiI(Ti ≤ τ) + τI(Ti &gt; τ), i = 1, . . . , n. Suppose τ = 1 and the observed Yi values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85 Use the E-M algorithm to estimate λ, compare your result with the observed data MLE (note: Yi follows a mixture distribution)</p>
</div>
<div id="solutions" class="section level2">
<h2>Solutions</h2>
<div id="section-6" class="section level3">
<h3>11.3</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>Euclid <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>term_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k){</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k) <span class="sc">*</span> (<span class="fu">Euclid</span>(a))<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="fl">+1.5</span>)<span class="sc">/</span><span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(c) <span class="sc">&gt;</span> <span class="fl">1e-100</span>){</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(term_k(a, k))</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> <span class="fu">term_k</span>(a, k)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> <span class="fu">term_k</span>(a, k)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="fu">S</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p>As is showed above , the sum when a = (1, 2) is 1.532164</p>
</div>
<div id="section-7" class="section level3">
<h3>11.5</h3>
<p>首先，我们对等式两边同时取对数，这不改变方程的根(积分用integ1/2代替) <span class="math display">\[log2 + log\Gamma(k/2)-\frac{1}{2}log\pi - \frac{1}{2}log(k-1) - log\Gamma(\frac{k-1}{2}) - log(integ1) \\
= log2 + log\Gamma((k+1)/2)-\frac{1}{2}log\pi - \frac{1}{2}log(k) - log\Gamma(\frac{k}{2}) - log(integ2)\]</span> 也即 <span class="math display">\[(log(k) - log(k-1))/2 + (2log\Gamma(k/2) - log\Gamma((k+1)/2)- log\Gamma((k-1)/2)) +log(integ1) - log(integ2) = 0\]</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k){</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k <span class="sc">/</span> (k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>inted <span class="ot">=</span> <span class="cf">function</span>(k,u){</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>equation11_5 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k){</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>   (<span class="fu">log</span>(k) <span class="sc">-</span> <span class="fu">log</span>(k<span class="dv">-1</span>))<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span> <span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">integrate</span>(inted, <span class="dv">0</span>, <span class="fu">c_k</span>(a, k<span class="dv">-1</span>), <span class="at">k =</span> k<span class="dv">-1</span>)<span class="sc">$</span>value) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">integrate</span>(inted, <span class="dv">0</span>, <span class="fu">c_k</span>(a, k), <span class="at">k =</span> k)<span class="sc">$</span>value)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>root11_5 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>), <span class="cf">function</span>(k){<span class="fu">uniroot</span>(equation11_5, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">k=</span>k)<span class="sc">$</span>root})</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co">#root11_5 &lt;- sapply(c(4:25,100,500,1000),function(k){uniroot(equation11_5, interval = c(0, sqrt(k)))$root})</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>equation11_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k){</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>(<span class="fu">c_k</span>(a, k<span class="dv">-1</span>), <span class="at">df =</span> k<span class="dv">-1</span>) <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">c_k</span>(a, k), <span class="at">df =</span> k)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>root11_4 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>), <span class="cf">function</span>(k){<span class="fu">uniroot</span>(equation11_4, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">k=</span>k)<span class="sc">$</span>root})</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="co">#root11_4 &lt;- sapply(c(4:25,100,500,1000),function(k){uniroot(equation11_5, interval = c(0, sqrt(k)))$root})</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="fu">cbind</span>(root11_5, root11_4)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(root) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;root in 11.5&quot;</span>, <span class="st">&quot;root in 11.4&quot;</span>)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(root) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>))</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(root)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">root in 11.5</th>
<th align="right">root in 11.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4</td>
<td align="right">1.492088</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">1.533559</td>
<td align="right">1.533556</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">1.562747</td>
<td align="right">1.562744</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">1.584435</td>
<td align="right">1.584430</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">1.601193</td>
<td align="right">1.601185</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">1.614533</td>
<td align="right">1.614521</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">1.625405</td>
<td align="right">1.625390</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">1.634436</td>
<td align="right">1.634419</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="right">1.641997</td>
<td align="right">1.642038</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="right">1.648515</td>
<td align="right">1.648554</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="right">1.654154</td>
<td align="right">1.654190</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="right">1.659080</td>
<td align="right">1.659114</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="right">1.663420</td>
<td align="right">1.663452</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="right">1.667273</td>
<td align="right">1.667304</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="right">1.670716</td>
<td align="right">1.670745</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="right">1.673812</td>
<td align="right">1.673840</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="right">1.676611</td>
<td align="right">1.676637</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="right">1.679153</td>
<td align="right">1.679178</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="right">1.681471</td>
<td align="right">1.681496</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="right">1.683594</td>
<td align="right">1.683620</td>
</tr>
<tr class="odd">
<td align="left">24</td>
<td align="right">1.685546</td>
<td align="right">1.685572</td>
</tr>
<tr class="even">
<td align="left">25</td>
<td align="right">1.687347</td>
<td align="right">1.687373</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="right">1.720599</td>
<td align="right">1.720608</td>
</tr>
<tr class="even">
<td align="left">500</td>
<td align="right">1.729745</td>
<td align="right">1.729756</td>
</tr>
<tr class="odd">
<td align="left">1000</td>
<td align="right">1.730897</td>
<td align="right">1.730908</td>
</tr>
</tbody>
</table>
<p>可以看到，11.5和11.4算出的根很接近。</p>
</div>
<div id="em算法" class="section level3">
<h3>EM算法</h3>
<p>对于估测值<span class="math inline">\(Y_i\)</span>，令随机变量<span class="math inline">\(Y\)</span>具有分布函数<span class="math inline">\(F_Y\)</span>,则 <span class="math display">\[
\begin{aligned}
F_Y(y) 
&amp;= P(Y \leq y) \\
&amp;= P(T I(T \leq \tau) + \tau I(T&gt;\tau) \leq y) \\
&amp;= P(T \leq \tau) P(T \leq y) + P(T&gt;\tau)P(\tau \leq y) \\
&amp;= 0.7P(T \leq y) + 0.3P(1 \leq y) \\
&amp;= 0.7 \int_0^y \lambda e^{-\lambda x}dx + 0.3 P(1 \leq y)
\end{aligned}
\]</span> 当<span class="math inline">\(y&gt;1\)</span>时，有 <span class="math display">\[F_Y(y) = 1-0.7e^{-\lambda y}\]</span> 当<span class="math inline">\(0 &lt; y \leq 1\)</span>时，有 <span class="math display">\[F_Y(y) = 0.7-0.7e^{-\lambda y}\]</span> 易知： <span class="math display">\[f(y)=0.7 \lambda e^{-\lambda y},y&gt;0\]</span> 因此，观测值的似然函数为 <span class="math display">\[f(\pmb{y}|\lambda)=0.7^{10} \lambda e^{-\lambda \sum_{i=1}^{10} y_i}\]</span> 容易求得，<span class="math inline">\(\lambda\)</span>的极大似然为 <span class="math display">\[\hat{\lambda} = \frac{1}{\sum_{i=1}^{10} y_i} = 0.1481481\]</span> EM算法步骤： 初始化<span class="math inline">\(\lambda^{(1)}\)</span>,令 <span class="math display">\[Z_i=\sum_{i=1}^{10}I(y_i&lt;1)\]</span> 则根据样本得到的似然函数为 <span class="math display">\[
\begin{aligned}
f(\pmb{y}|\lambda_1) 
&amp;\propto  \lambda^{Z_i} e^{-\lambda \sum_{i=1}^{10} y_iI(y_i&lt;1)} (\int_1^{\infty} \lambda e^{-\lambda t} dt)^{10-Z_i} \\
&amp;= \lambda^{Z_i}e^{-3.75\lambda} (e^{-\lambda_1})^{10-Z_i}
\end{aligned}
\]</span> 假设<span class="math inline">\(\lambda\)</span>的先验分布为均匀分布，则 <span class="math display">\[\pi(\lambda|\pmb{y}) \propto  \lambda^{Z_i}e^{-3.75\lambda} (e^{-\lambda})^{10-Z_i}\]</span> E步： <span class="math display">\[Q(\lambda, \lambda^{(i)})= E[Z_iln\lambda-3.75\lambda -10\lambda+\lambda Z_i|\lambda^{(i)},\pmb{y}]\]</span> M步为最大化Q，为此求导并令为0，得： <span class="math display">\[\hat{\lambda}^{(i+1)} = \frac{E[Z_i]}{13.75-E[Z_i]}\]</span> 其中，<span class="math inline">\(Z \sim B(10,p),\quad p = \int_0^1 \hat{\lambda}^{(i)}e^{-\hat{\lambda}^{(i)} t}dt = 1-e^{-\hat{\lambda}^{(i)}}\)</span>，故<span class="math inline">\(E[Z_i] = 10-10e^{-\hat{\lambda}^{(i)}}\)</span>，代入 <span class="math display">\[\hat{\lambda}^{(i+1)} = \frac{10-10e^{-\hat{\lambda}^{(i)}}}{13.75-10+10e^{-\hat{\lambda}^{(i)}}} = \frac{10e^{\hat{\lambda}^{(i)}}-10}{3.75e^{\hat{\lambda}^{(i)}}+10}\]</span> 迭代10次得到：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#初始化参数为1</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i<span class="sc">&lt;</span><span class="dv">10</span>) {</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> (<span class="dv">10</span><span class="sc">*</span><span class="fu">exp</span>(lambda)<span class="sc">-</span><span class="dv">10</span>)<span class="sc">/</span>(<span class="fl">3.75</span><span class="sc">*</span><span class="fu">exp</span>(lambda)<span class="sc">+</span><span class="dv">10</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>lambda </span></code></pre></div>
<pre><code>## [1] 0.1349839</code></pre>
<p>这于前面所得的极大似然估计十分接近。</p>
</div>
</div>
<div id="a-21041-2021-11-25" class="section level2">
<h2>A-21041-2021-11-25</h2>
</div>
<div id="questions-6" class="section level2">
<h2>Questions:</h2>
<p>Exercise 1 and 5(page204,Advanced R)</p>
<p>Exercise 1 and 7(page214,Advanced R)</p>
</div>
<div id="solutions-1" class="section level2">
<h2>Solutions</h2>
<div id="p204-1" class="section level3">
<h3>P204-1</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.1037817
## 
## [[2]]
## [1] -0.2103385
## 
## [[3]]
## [1] -0.1689894
## 
## [[4]]
## [1] -0.09482398</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.1037817
## 
## [[2]]
## [1] -0.2103385
## 
## [[3]]
## [1] -0.1689894
## 
## [[4]]
## [1] -0.09482398</code></pre>
<p>如程序所示，两个lapply所得结果相等 函数lapply的原理是遍历向量中的每个元素，并使用指定的函数处理其元素，lapply函数返回向量列表。例如,当trims是0.1,这意味着100 * 0.1 = 10位数的最大值和最小值被删除，然后取平均值。对于Lapply(trims,mean,x=x)，将给定向量trims中的元素直接作为均值函数的参数，将x作为Lapply中的其他参数。因此，不需要另外定义函数，所以得到的结果是一样的。</p>
</div>
<div id="p204-5" class="section level3">
<h3>P204-5</h3>
<p>程序如下：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#模型P204-3</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">#模型P204-4</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#模型P204-5</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">lapply</span>(formulas, lm, <span class="at">data=</span>mtcars), rsq)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#输出各个R平方</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
</div>
<div id="p214-1" class="section level3">
<h3>P214-1</h3>
<div id="a" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">x1=</span><span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">5</span>),<span class="at">x2=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(x, sd, <span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span><span class="ot">=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>##       x1       x2 
## 6.454972 1.290994</code></pre>
<p>如上所示，向量<span class="math inline">\(x_1\)</span>的标准差为6.454972，向量<span class="math inline">\(x_2\)</span>的标准差为1.290994。</p>
</div>
<div id="b-1" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">5</span>), <span class="at">b=</span><span class="fu">runif</span>(<span class="dv">5</span>), <span class="at">c=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sd_1 <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>sd_2 <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x[sd_1], sd, <span class="at">FUN.VALUE =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span><span class="ot">=</span><span class="dv">0</span>))</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sd_2)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">a</td>
<td align="right">7.9056942</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="right">0.2752602</td>
</tr>
</tbody>
</table>
<p>结果如上</p>
</div>
</div>
<div id="p214-7" class="section level3">
<h3>P214-7</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define the fuction of mcvapply</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>mcvapply <span class="ot">&lt;-</span> <span class="cf">function</span> (<span class="at">cl =</span> <span class="cn">NULL</span>, X, fun, ..., <span class="at">chunk.size =</span> <span class="cn">NULL</span>) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    cl <span class="ot">&lt;-</span> <span class="fu">defaultCluster</span>(cl)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    nchunks <span class="ot">&lt;-</span> <span class="fu">staticNChunks</span>(<span class="fu">length</span>(X), <span class="fu">length</span>(cl), chunk.size)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(c, <span class="fu">clusterApply</span>(<span class="at">cl =</span> cl, <span class="at">x =</span> <span class="fu">splitList</span>(X, nchunks), </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> sapply, <span class="at">FUN =</span> fun, ...), <span class="at">quote =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="a-21041-2021-12-02" class="section level2">
<h2>A-21041-2021-12-02</h2>
<pre><code>library(Rcpp)
library(microbenchmark)

cppFunction(&#39;NumericMatrix gibbsC(int N, int n,int a,int b) {
  NumericMatrix mat(N, 2);
  double x = 0, y = 0;
  for(int i = 1; i &lt; N; i++) {
    y=mat(i-1,1);
    mat(i,0)=rbinom(1, n, y)[0];
    x=mat(i,0);
    mat(i,1)=rbeta(1, x+a, n-x+b)[0];
  }
  return(mat);
}&#39;)

#pure R
set.seed(10101)
a &lt;- 10101
b &lt;- a+1
for (i in 1:9){
  b = i+1
}

gibbsR_R &lt;- function(N, n, a, b) {
  mat &lt;- matrix(nrow = N, ncol = 2)
  mat[1,] &lt;- c(0,0)
  mat
  for (i in 2:N) {
    y &lt;- mat[i-1,2]
    mat[i,1] &lt;- rbinom(1,n,y)
    x &lt;- mat[i,1]
    mat[i,2]&lt;-rbeta(1, x+a, n-x+b)
  }
  mat
}</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
